version: "3.7"
services:
  node:
    build:
      target: nodeServer
      context: ../
      dockerfile: docker/Dockerfile
    container_name: node
    restart: unless-stopped
    networks:
      - internal
    labels:
    - traefik.enable=false



  nginx:
    build:
      target: webServer
      context: ../
      dockerfile: docker/Dockerfile
    container_name: nginx
    restart: unless-stopped
    networks:
      - traefik
      - internal
    labels:
      - traefik.frontend.rule=Host:mrtolerant.ru
      - traefik.docker.network=traefik
    depends_on:
      - node

networks:
  internal:
  traefik:
    external:
      name: traefik

